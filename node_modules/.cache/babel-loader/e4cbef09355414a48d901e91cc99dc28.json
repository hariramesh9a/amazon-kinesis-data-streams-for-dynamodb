{"ast":null,"code":"import _regeneratorRuntime from\"/Users/goesamee/Documents/Work/GSI/External Content/DynamoDB_Streaming_Blog/BlogTemplate/ddb-streaming-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/goesamee/Documents/Work/GSI/External Content/DynamoDB_Streaming_Blog/BlogTemplate/ddb-streaming-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/goesamee/Documents/Work/GSI/External Content/DynamoDB_Streaming_Blog/BlogTemplate/ddb-streaming-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useForm}from\"react-hook-form\";import'./App.css';import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faSync,faSave}from\"@fortawesome/free-solid-svg-icons\";import Amplify,{API}from'aws-amplify';import awsconfig from'./aws-exports';import*as mutations from'./graphql/mutations';import*as queries from'./graphql/queries';import ddblogo from'./images/Amazon-DynamoDB_lgt.png';import toast from\"light-toast\";import{yupResolver}from'@hookform/resolvers/yup';import*as yup from\"yup\";import{ResponsiveContainer,Tooltip,XAxis,YAxis,CartesianGrid,LineChart,Line}from'recharts';Amplify.configure(awsconfig);function Windspeed(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),mylist=_useState2[0],setMyList=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),mySortedlist=_useState4[0],setMySortedList=_useState4[1];var _useState5=useState(10),_useState6=_slicedToArray(_useState5,2),loop=_useState6[0],setLoop=_useState6[1];var _useState7=useState(25),_useState8=_slicedToArray(_useState7,2),lower=_useState8[0],setLower=_useState8[1];var _useState9=useState(70),_useState10=_slicedToArray(_useState9,2),upper=_useState10[0],setUpper=_useState10[1];var _useState11=useState(\"false\"),_useState12=_slicedToArray(_useState11,2),animation=_useState12[0],setAnimation=_useState12[1];useEffect(function(){updateVals();},[]);function genValues(){return _genValues.apply(this,arguments);}function _genValues(){_genValues=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var i,generateValues;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:i=0;case 1:if(!(i<loop)){_context2.next=8;break;}generateValues={deviceID:\"device\"+(Math.floor(Math.random()*5)+1),value:Math.floor(Math.random()*upper)+lower};_context2.next=5;return API.graphql({query:mutations.createWindspeed,variables:{input:generateValues}});case 5:i++;_context2.next=1;break;case 8:case\"end\":return _context2.stop();}}},_callee2);}));return _genValues.apply(this,arguments);}var refresh=function refresh(){toast.success(\"Fetcing values from DynamoDB\",1000,function(){updateVals();});};function generate(){genValues();toast.success(\"Generating \".concat(loop,\" values between \").concat(lower,\" and \").concat(upper),1000,function(){updateVals();});}var updateVals=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return API.graphql({query:queries.listWindspeeds,fetchPolicy:\"no-cache\"});case 2:result=_context.sent;setMyList(result.data.listWindspeeds.items);case 4:case\"end\":return _context.stop();}}},_callee);}));return function updateVals(){return _ref.apply(this,arguments);};}();var myChartArray=[];var generateKeyValePairs=function generateKeyValePairs(arraytoupdated){mylist.map(function(item,index){var objNeeded={date:'',name:'init',value:-1};objNeeded['date']=item.createdAt;objNeeded['name']=index+1;objNeeded['value']=item.value;arraytoupdated.push(objNeeded);});};generateKeyValePairs(myChartArray);var SortList=function SortList(){console.log('unsort',myChartArray);var ordered={};Object.keys(myChartArray).sort().forEach(function(key){ordered[key]=myChartArray[key];});setMySortedList(ordered);console.log('ordered_list',ordered);};function CustomizedLabel(props){var x=props.x,y=props.y,stroke=props.stroke,value=props.value;if(value>55||value<30){return/*#__PURE__*/React.createElement(\"text\",{x:x,y:y,dy:-4,fill:\"red\",fontSize:10,textAnchor:\"middle\"},value);}else{return/*#__PURE__*/React.createElement(\"text\",{x:x,y:y,dy:-4,fill:\"green\",fontSize:10,textAnchor:\"middle\"},value);}}function CreateLineChart(val){return/*#__PURE__*/React.createElement(ResponsiveContainer,{width:\"100%\",minHeight:400},/*#__PURE__*/React.createElement(LineChart,{data:val.data,margin:{top:20,right:20,left:20,bottom:10}},/*#__PURE__*/React.createElement(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/React.createElement(XAxis,{tick:true}),/*#__PURE__*/React.createElement(YAxis,null),/*#__PURE__*/React.createElement(Tooltip,null),/*#__PURE__*/React.createElement(Line,{type:\"monotone\",isAnimationActive:false,dataKey:\"value\",stroke:\"#8884d8\",strokeWidth:2,label:/*#__PURE__*/React.createElement(CustomizedLabel,null)})));}var schema=yup.object().shape({numberofvals:yup.number().positive().integer().required(),lowerLimit:yup.number().positive().integer().required(),upperLimit:yup.number().positive().integer().required()});var _useForm=useForm({resolver:yupResolver(schema)}),handleSubmit=_useForm.handleSubmit,register=_useForm.register,errors=_useForm.errors;var onSubmit=function onSubmit(data){toast.success(\"Updating Values: \".concat(loop,\" Min: \").concat(lower,\" Max: \").concat(upper),500,function(){console.log('data->',data);setLoop(data.numberofvals);setLower(data.lowerLimit);setUpper(data.upperLimit);});};return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(\"header\",{className:\"App-header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"App-form\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"label\",null,\"Values\"),/*#__PURE__*/React.createElement(\"input\",{name:\"numberofvals\",defaultValue:loop,type:\"number\",min:\"1\",max:\"99\",ref:register({min:10,max:99}),onChange:function onChange(e){return setLoop(e.target.value);}}),/*#__PURE__*/React.createElement(\"label\",null,\"Min\"),/*#__PURE__*/React.createElement(\"input\",{name:\"lowerLimit\",defaultValue:lower,type:\"number\",min:\"1\",max:\"99\",ref:register({min:10,max:99}),onChange:function onChange(e){return setLower(e.target.value);}}),/*#__PURE__*/React.createElement(\"label\",null,\"Max\"),/*#__PURE__*/React.createElement(\"input\",{name:\"upperLimit\",defaultValue:upper,type:\"number\",min:\"1\",max:\"99\",ref:register({min:10,max:99}),onChange:function onChange(e){return setUpper(e.target.value);}}),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"Save \",\" \",/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faSave})))),/*#__PURE__*/React.createElement(\"div\",{className:\"App-buttons\"},/*#__PURE__*/React.createElement(\"button\",{onClick:generate},\"Generate data\"),/*#__PURE__*/React.createElement(\"button\",{onClick:refresh},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faSync})),/*#__PURE__*/React.createElement(\"a\",{href:\"https://us-west-2.console.aws.amazon.com/dynamodb/home?region=us-west-2#tables:\",target:\"_blank\",rel:\"noopener noreferrer\"},/*#__PURE__*/React.createElement(\"img\",{src:ddblogo,alt:\"Logo\"}))),/*#__PURE__*/React.createElement(CreateLineChart,{data:myChartArray}),/*#__PURE__*/React.createElement(\"div\",{className:\"App-info\"},/*#__PURE__*/React.createElement(\"p\",null,\"Every wind turbine has a range of wind speeds, typically around 30 to 55 mph. Speed other than this range is detected anomalous.\",\" \",/*#__PURE__*/React.createElement(\"a\",{href:\"https://www.wind-watch.org/faq-output.php\",target:\"_blank\",rel:\"noopener noreferrer\"},\"source\")))));}export default Windspeed;","map":{"version":3,"sources":["/Users/goesamee/Documents/Work/GSI/External Content/DynamoDB_Streaming_Blog/BlogTemplate/ddb-streaming-ui/src/Windspeed.jsx"],"names":["React","useEffect","useState","useForm","FontAwesomeIcon","faSync","faSave","Amplify","API","awsconfig","mutations","queries","ddblogo","toast","yupResolver","yup","ResponsiveContainer","Tooltip","XAxis","YAxis","CartesianGrid","LineChart","Line","configure","Windspeed","mylist","setMyList","mySortedlist","setMySortedList","loop","setLoop","lower","setLower","upper","setUpper","animation","setAnimation","updateVals","genValues","i","generateValues","deviceID","Math","floor","random","value","graphql","query","createWindspeed","variables","input","refresh","success","generate","listWindspeeds","fetchPolicy","result","data","items","myChartArray","generateKeyValePairs","arraytoupdated","map","item","index","objNeeded","date","name","createdAt","push","SortList","console","log","ordered","Object","keys","sort","forEach","key","CustomizedLabel","props","x","y","stroke","CreateLineChart","val","top","right","left","bottom","schema","object","shape","numberofvals","number","positive","integer","required","lowerLimit","upperLimit","resolver","handleSubmit","register","errors","onSubmit","min","max","e","target"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport { useForm } from \"react-hook-form\";\nimport './App.css';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSync, faSave } from \"@fortawesome/free-solid-svg-icons\";\nimport Amplify, {API} from 'aws-amplify';\nimport awsconfig from './aws-exports';\nimport * as mutations from './graphql/mutations';\nimport * as queries from './graphql/queries';\nimport ddblogo from './images/Amazon-DynamoDB_lgt.png'\nimport toast from \"light-toast\";\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport * as yup from \"yup\";\nimport {\n  ResponsiveContainer, Tooltip, XAxis, YAxis, CartesianGrid, LineChart, Line,\n} from 'recharts';\nAmplify.configure(awsconfig);\n\nfunction Windspeed() {\n  \n  const [mylist, setMyList] = useState([]);\n  const [mySortedlist, setMySortedList] = useState([]);\n  const [loop, setLoop] = useState(10);\n  const [lower, setLower] = useState(25);\n  const [upper, setUpper] = useState(70);\n  const [animation, setAnimation]= useState(\"false\")\n\n  useEffect(() => {\n    updateVals();\n  }, []);\n\n  async function genValues () {\n    for (let i = 0; i < loop; i++) {\n    const generateValues = { \n      deviceID: \"device\" + (Math.floor(Math.random() * 5) + 1),\n      value: Math.floor(Math.random() * upper) + lower\n    };\n    await API.graphql({ query: mutations.createWindspeed, variables: { input: generateValues}});\n    }\n  }\n  const refresh = () => {\n    toast.success(`Fetcing values from DynamoDB`, 1000, () => {\n      updateVals();\n    }); \n  }\n  function generate () {\n    genValues();\n    toast.success(`Generating ${loop} values between ${lower} and ${upper}`, 1000, () => {\n        updateVals();\n    }); \n  }\n\n  const updateVals = async() =>{\n    const result = await API.graphql({\n      query: queries.listWindspeeds,\n      fetchPolicy: \"no-cache\",\n    });\n    setMyList(result.data.listWindspeeds.items);\n  };\n\n  const myChartArray = [];\n  const generateKeyValePairs = (arraytoupdated) => {\n    mylist.map((item, index) => {\n    var objNeeded = { date: '', name: 'init', value: -1};\n    objNeeded['date'] = item.createdAt;\n    objNeeded['name'] = index+1;\n    objNeeded['value'] = item.value;\n    arraytoupdated.push(objNeeded);\n    });\n  }\n  generateKeyValePairs(myChartArray);\n\n    const SortList = () => {\n      console.log('unsort',myChartArray);\n      const ordered = {};\n      Object.keys(myChartArray).sort().forEach(function(key) {\n      ordered[key] = myChartArray[key];\n      });\n      setMySortedList(ordered);\n      console.log('ordered_list',ordered);\n    }\n\n  function CustomizedLabel(props) {\n    const { x, y, stroke, value } = props;\n    if (value > 55 || value < 30) {\n    return (\n      <text x={x} y={y} dy={-4} fill=\"red\" fontSize={10} textAnchor=\"middle\">\n        {value}\n      </text>\n    );\n    }else{\n      return (\n        <text x={x} y={y} dy={-4} fill=\"green\" fontSize={10} textAnchor=\"middle\" >\n          {value}\n        </text>\n      );\n    }\n  }\n\n  function CreateLineChart(val){\n    return(\n      <ResponsiveContainer width=\"100%\" minHeight={400}>\n        <LineChart\n          data={val.data}\n          margin={{\n            top: 20, right: 20, left: 20, bottom: 10,\n          }}\n          >\n          <CartesianGrid strokeDasharray=\"3 3\" />\n          <XAxis tick={true}/>\n          <YAxis />\n          <Tooltip />\n          <Line type=\"monotone\" isAnimationActive={false} dataKey=\"value\" stroke=\"#8884d8\" strokeWidth={2} label={<CustomizedLabel />} />\n        </LineChart>\n      </ResponsiveContainer>\n      )\n  }\n\n  \n  const schema = yup.object().shape({\n    numberofvals: yup.number().positive().integer().required(),\n    lowerLimit: yup.number().positive().integer().required(),\n    upperLimit: yup.number().positive().integer().required(),\n  });\n\n  const { handleSubmit, register, errors } = useForm({resolver: yupResolver(schema)});\n  const onSubmit = data => {\n    toast.success(`Updating Values: ${loop} Min: ${lower} Max: ${upper}`, 500, () => {\n      console.log('data->',data);\n      setLoop(data.numberofvals);\n      setLower(data.lowerLimit);\n      setUpper(data.upperLimit);\n    });\n  }\n\n  return (\n    <div className=\"App\">\n      {/* <AmplifySignOut /> */}\n      <header className=\"App-header\">\n      <div className=\"App-form\">\n        <form onSubmit={handleSubmit(onSubmit)}>\n          \n          <label>Values</label>\n          <input name=\"numberofvals\" defaultValue={loop} type=\"number\" min =\"1\" max=\"99\"\n          ref={register({ min: 10, max: 99 })} \n          onChange={e => setLoop(e.target.value)}\n          />\n\n          <label>Min</label>\n          <input name=\"lowerLimit\" defaultValue={lower} type=\"number\" min =\"1\" max=\"99\"\n          ref={register({ min: 10, max: 99 })} \n          onChange={e => setLower(e.target.value)}\n          />\n\n          <label>Max</label>\n          <input name=\"upperLimit\" defaultValue={upper} type=\"number\" min =\"1\" max=\"99\"\n          ref={register({ min: 10, max: 99 })} \n          onChange={e => setUpper(e.target.value)}\n          />            \n          <button type=\"submit\">Save {\" \"}<FontAwesomeIcon icon={faSave} /></button>\n\n          </form>\n        </div>\n\n        <div className=\"App-buttons\">\n          <button onClick={generate}>\n            Generate data\n          </button>\n\n          <button onClick={refresh}>\n            <FontAwesomeIcon icon={faSync}/>\n          </button>\n        \n        <a href=\"https://us-west-2.console.aws.amazon.com/dynamodb/home?region=us-west-2#tables:\" target=\"_blank\" rel=\"noopener noreferrer\">\n          <img src={ddblogo} alt=\"Logo\" />\n        </a> \n        </div>\n        <CreateLineChart data={myChartArray} />\n        <div className=\"App-info\">\n        <p>Every wind turbine has a range of wind speeds, typically around 30 to 55 mph. Speed other than this range is detected anomalous.{\" \"}\n        <a href=\"https://www.wind-watch.org/faq-output.php\" target=\"_blank\" rel=\"noopener noreferrer\">\n        source\n        </a>\n        </p>\n        </div>\n      </header>\n    </div>\n  );\n}\n\nexport default Windspeed;\n"]},"metadata":{},"sourceType":"module"}