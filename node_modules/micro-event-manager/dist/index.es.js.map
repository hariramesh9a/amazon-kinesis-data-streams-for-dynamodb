{"version":3,"file":"index.es.js","sources":["../src/index.ts"],"sourcesContent":["type Fn = (data?: any) => void;\n\ninterface Event {\n  key: number;\n  callback: Fn;\n}\n\ninterface PublishedEvents {\n  name: string;\n  data?: any;\n}\n\nclass EventManager {\n  _events: { [key: string]: Event[] } = {};\n\n  _publishedEvents: PublishedEvents[] = [];\n\n  subscribe(name: string, callback: Fn): number {\n    if (!this._events[name]) {\n      this._events[name] = [];\n    }\n    const event = { key: Date.now(), callback };\n    this._events[name].push(event);\n    return event.key;\n  }\n\n  publish(name: string, data?: any): void {\n    this._publishedEvents.push({ name, data });\n    if (this._events[name]) {\n      this._events[name].forEach(({ callback }): void => {\n        callback(data);\n      });\n    }\n  }\n\n  unSubscribe(name: string, key: number): void {\n    if (this._events[name]) {\n      for (let i = 0; i < this._events[name].length; i++) {\n        if (key === this._events[name][i].key) {\n          this._events[name].splice(i, 1);\n          break;\n        }\n      }\n    }\n  }\n\n  // Make sure published events can be triggered when subscribed\n  ensureTriggeredAndSubscribe(name: string, callback: Fn): number {\n    const event = this._publishedEvents\n      .slice()\n      .reverse()\n      .find((item) => item.name === name);\n    if (event) {\n      callback(event.data);\n    }\n    return this.subscribe(name, callback);\n  }\n}\n\nconst eventManager = new EventManager();\n\nexport default eventManager;\n"],"names":[],"mappings":"AAYA;IAAA;QACE,YAAO,GAA+B,EAAE,CAAC;QAEzC,qBAAgB,GAAsB,EAAE,CAAC;KA0C1C;IAxCC,gCAAS,GAAT,UAAU,IAAY,EAAE,QAAY;QAClC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACvB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;SACzB;QACD,IAAM,KAAK,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,EAAE,QAAQ,UAAA,EAAE,CAAC;QAC5C,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC/B,OAAO,KAAK,CAAC,GAAG,CAAC;KAClB;IAED,8BAAO,GAAP,UAAQ,IAAY,EAAE,IAAU;QAC9B,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAE,IAAI,MAAA,EAAE,IAAI,MAAA,EAAE,CAAC,CAAC;QAC3C,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACtB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,UAAC,EAAY;oBAAV,QAAQ,cAAA;gBACpC,QAAQ,CAAC,IAAI,CAAC,CAAC;aAChB,CAAC,CAAC;SACJ;KACF;IAED,kCAAW,GAAX,UAAY,IAAY,EAAE,GAAW;QACnC,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACtB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAClD,IAAI,GAAG,KAAK,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;oBACrC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;oBAChC,MAAM;iBACP;aACF;SACF;KACF;;IAGD,kDAA2B,GAA3B,UAA4B,IAAY,EAAE,QAAY;QACpD,IAAM,KAAK,GAAG,IAAI,CAAC,gBAAgB;aAChC,KAAK,EAAE;aACP,OAAO,EAAE;aACT,IAAI,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,IAAI,KAAK,IAAI,GAAA,CAAC,CAAC;QACtC,IAAI,KAAK,EAAE;YACT,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SACtB;QACD,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;KACvC;IACH,mBAAC;AAAD,CAAC,IAAA;IAEK,YAAY,GAAG,IAAI,YAAY;;;;"}